---
import BaseLayout from "../../layouts/BaseLayout.astro";
import TreePage from "../../components/TreePage.astro";
import type { TreeNode } from "../../data/siteTree";
import { findNodeBySegments, getPathForNode, siteTree } from "../../data/siteTree";
import { buildCollectionSchemaNodes, buildLeafSchemaNodes } from "../../lib/geo";
import { withLang } from "../../lib/i18n";
import { getPageUpdatedIso } from "../../lib/page-updates";
import { buildLeafQuickAnswer } from "../../lib/leafQuickAnswer";
import { absoluteUrl } from "../../lib/site";

type NodeContentBlock = NonNullable<TreeNode["content"]>[number];

const ES_LEAF_OVERRIDES: Record<
  string,
  Partial<Pick<TreeNode, "title" | "description" | "quickAnswer" | "updatedIso">> & {
    content?: NodeContentBlock[];
  }
> = {
  "travel-basics": {
    title: "Basicos de Viaje",
    description: "Internet, pagos y seguridad con menos estres.",
    quickAnswer:
      "Enfocate en 3 basicos: internet, pagos y seguridad. En unos 5 minutos puedes decidir lo esencial y viajar con menos estres.",
  },
  "latest-travel-updates-for-korea": {
    title: "Ultimas Actualizaciones de Viaje para Corea",
    description: "Fuentes oficiales para confirmar antes de viajar.",
    quickAnswer:
      "Usa esta pagina como verificacion final antes de reservar o volar.",
    content: [
      {
        title: "Ultimas Actualizaciones de Viaje para Corea",
        icon: "shield",
        emphasis: "Fuentes oficiales para confirmar antes de viajar",
        body:
          "La informacion de viaje en Corea del Sur puede cambiar mas rapido que cualquier guia. Usa esta pagina como verificacion final antes de reservar o volar.",
        bullets: [
          "Primero planifica. Aqui confirmas. Viaja con confianza.",
        ],
      },
      {
        title: "Entrada e Inmigracion",
        icon: "passport",
        emphasis:
          "Las reglas de entrada y autorizacion dependen de tu nacionalidad y pueden cambiar sin aviso.",
        body: "Confirma siempre tu estado de entrada antes de salir.",
        bullets: [
          "K-ETA (sistema oficial de autorizacion) - Si tu pais esta exento de visa, solicita antes del viaje. https://www.k-eta.go.kr/portal/apply/index.do?locale=EN",
          "e-Arrival Card (formulario de llegada en linea) - Declaracion de llegada en linea (envio dentro de los 3 dias antes de llegar). https://www.e-arrivalcard.go.kr/portal/main/index.do?locale=EN",
          "Procedimientos de llegada e inmigracion - Incheon Airport: https://www.airport.kr/ap_en/1439/subview.do",
        ],
      },
      {
        title: "Transporte y Aeropuertos",
        icon: "train",
        emphasis:
          "Los horarios de tren, procesos de aeropuerto y precios de transporte pueden variar en feriados y temporadas altas.",
        body:
          "Los horarios de tren, procesos de aeropuerto y precios de transporte pueden variar en feriados y temporadas altas.",
        bullets: [
          "Incheon International Airport (ingles) - Procedimientos de llegada, info de terminal y opciones de transporte. https://www.airport.kr/sites/ap_en/index.do",
          "Seul - Llegar a Seul desde Incheon Airport (oficial) - Opciones oficiales de traslado (incluye AREX y buses limusina). https://english.seoul.go.kr/service/entry/getting-to-seoul-from-incheon-airport/",
          "Korail - Trenes de alta velocidad y regionales (KTX) - Horarios nacionales, rutas y tickets. https://www.korail.com/global/eng/intro",
          "AREX (Airport Railroad Express) - Tren entre Incheon y Seul. https://www.arex.or.kr (interfaz en ingles disponible)",
          "Transporte publico de Seul (pagina oficial en ingles). https://english.seoul.go.kr/service/movement/public-transportation/",
          "Transporte publico de Busan (pagina oficial en ingles). https://www.busan.go.kr/eng/public-transportation",
        ],
      },
      {
        title: "Clima y Condiciones por Temporada",
        icon: "cloud",
        emphasis:
          "El clima afecta mucho los planes de viaje, sobre todo en verano e invierno.",
        body:
          "El clima afecta mucho los planes de viaje, sobre todo en verano e invierno.",
        bullets: [
          "Korea Meteorological Administration (ingles) - Pronosticos oficiales y alertas meteorologicas. https://www.kma.go.kr/neng/index.do",
        ],
      },
      {
        title: "Organizaciones Oficiales de Turismo",
        icon: "pin",
        emphasis: "Horarios, festivales y cierres se actualizan por ciudad.",
        body: "Horarios, festivales y cierres se actualizan por ciudad.",
        bullets: [
          "Korea Tourism Organization - Informacion nacional para planear. https://english.visitkorea.or.kr/svc/main/index.do",
          "Seoul Tourism Organization (sitio oficial en ingles) - Atracciones, barrios, comida y compras. https://english.visitseoul.net",
          "Busan Tourism Organization - Informacion de ciudad y consejos. https://english.busan.go.kr",
          "Jeju Tourism Organization - Atracciones y eventos en Jeju. https://www.visitjeju.net/en",
          "Gyeongju Tourism - Sitios historicos e informacion cultural. https://www.gyeongju.go.kr/tour/index.do",
          "Jeonju Tourism - Sitio oficial de turismo y cultura. https://tour.jeonju.go.kr/eng",
        ],
      },
      {
        title: "Seguridad y Avisos de Viaje",
        icon: "alert",
        emphasis:
          "Corea del Sur suele ser muy segura, pero las fuentes oficiales te ayudan a mantenerte al dia.",
        body: "Numeros de emergencia (24/7): Policia 112, Bomberos / Ambulancia 119",
        bullets: [
          "Ministry of Foreign Affairs - Travel Notices (ingles): https://www.mofa.go.kr/eng/index.do",
          "Linea de ayuda oficial al turista en Corea (1330) con opcion en ingles.",
          "Tambien revisa el sitio de la embajada de tu pais en Corea para apoyo consular.",
        ],
      },
      {
        title: "Pagos, Compras y Tax Refund",
        icon: "wallet",
        emphasis:
          "Las reglas de tax refund y los metodos de pago cambian segun tienda y ubicacion.",
        body:
          "Las reglas de tax refund y los metodos de pago cambian segun tienda y ubicacion.",
        bullets: [
          "Global Tax Free Korea - Tiendas participantes y proceso de reembolso. https://www.global-taxfree.com/?lang=en#1",
          "Korea Customs Service (ingles) - Limites duty-free y reglas de declaracion. https://www.customs.go.kr/english/main.do",
        ],
      },
      {
        title: "Como usar esta pagina",
        icon: "spark",
        emphasis: "Decide destino y duracion, luego confirma aqui.",
        body:
          "Muchos viajeros vuelven a esta pagina unos dias antes de volar para evitar sorpresas de ultimo minuto.",
        bullets: [
          "Usa estas fuentes oficiales para confirmar reglas y condiciones actuales.",
          "Revisa de nuevo requisitos de entrada, clima, transporte y aeropuertos antes de salir.",
          "Antes de reservar planes no reembolsables, revisa seguro de viaje para Corea.",
        ],
      },
    ],
  },
  "sim-or-esim": {
    title: "SIM o eSIM?",
    description: "Opciones de internet explicadas de forma simple.",
    quickAnswer:
      "Esta pagina te ayuda a elegir la opcion de internet mas simple para tu telefono.",
    content: [
      {
        title: "SIM o eSIM?",
        icon: "sim",
        emphasis: "Corea es conocida por su internet rapido y confiable.",
        body:
          "Necesitaras una buena conexion para mapas, transporte, pagos y traducciones. La clave es elegir la opcion que mejor se adapte a ti.",
      },
      {
        title: "Respuesta rapida",
        icon: "checklist",
        emphasis: "Una sola eleccion resuelve casi todo.",
        body:
          "Si tu telefono admite eSIM, elige eSIM. Si no, usa una SIM fisica.",
      },
      {
        title: "Que es una eSIM?",
        icon: "sim",
        emphasis: "Digital, simple y rapida.",
        body: "Por que a los viajeros les gusta:",
        bullets: [
          "Puedes configurarla antes de llegar",
          "No necesitas ir a una tienda en el aeropuerto",
          "Puedes mantener activa tu SIM de origen para mensajes o banca",
        ],
      },
      {
        title: "Cuando conviene mas una SIM fisica",
        icon: "card",
        emphasis: "Compatibilidad y soporte.",
        body: "Una SIM fisica es mejor si:",
        bullets: [
          "Tu telefono es antiguo",
          "No estas seguro de la compatibilidad con eSIM",
          "Prefieres ayuda presencial",
          "Quieres comprarla en el aeropuerto o en un operador",
        ],
      },
      {
        title: "Lo que realmente necesitas",
        icon: "spark",
        emphasis: "Primero los datos.",
        body: "Para la mayoria de viajeros:",
        bullets: [
          "Los planes solo de datos suelen ser suficientes",
          "Datos ilimitados dan mas comodidad",
          "Los minutos de llamada casi nunca son necesarios",
        ],
      },
      {
        title: "Precios orientativos (SIM y eSIM en Corea)",
        icon: "wallet",
        emphasis: "Rangos comunes para viajeros.",
        body: "SIM fisica y plan eSIM:",
        bullets: [
          "SIM fisica - Precio: aprox. 20,000-30,000 KRW (5GB-10GB)",
          "SIM fisica - Donde comprar: aeropuertos, tiendas grandes y mostradores de operadoras",
          "SIM fisica - Operadoras: SK Telecom, KT, LG U+",
          "eSIM - Precio: aprox. 15,000-25,000 KRW (5GB-10GB)",
          "eSIM - Donde comprar: en linea antes del viaje y activar al llegar",
          "eSIM - Operadoras: SK Telecom, KT",
        ],
      },
      {
        title: "Errores comunes que debes evitar",
        icon: "alert",
        emphasis: "Revisa la compatibilidad primero.",
        body: "Antes de comprar, confirma:",
        bullets: [
          "Modelo de tu telefono",
          "Soporte eSIM",
          "Compatibilidad de red",
        ],
      },
      {
        title: "Debes decidir todo ahora?",
        icon: "checklist",
        emphasis: "Elige opcion primero, confirma detalles despues.",
        body: "Los precios y planes pueden cambiar. Verifica siempre en:",
        bullets: [
          "Sitios oficiales de telecom",
          "Mostradores de telecom en aeropuerto",
          "Vendedores autorizados",
        ],
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Conectado siempre es la clave.",
        body:
          "Elige eSIM por rapidez y simplicidad. Elige SIM fisica por compatibilidad y soporte presencial.",
      },
    ],
  },
  "how-to-pay-in-korea": {
    title: "Como pagar en Corea",
    description: "Tarjeta, efectivo y lo que realmente funciona.",
    quickAnswer:
      "Esta pagina te ayuda a entender que metodos de pago funcionan de verdad en Corea.",
    content: [
      {
        title: "Como pagar en Corea",
        icon: "wallet",
        emphasis: "Las tarjetas se aceptan en casi todo, pero el efectivo aun sirve.",
        body:
          "No necesitas preocuparte demasiado por los pagos. En Corea es simple: usa tarjeta para casi todo y lleva algo de efectivo como respaldo.",
      },
      {
        title: "Tarjetas: que funciona mejor",
        icon: "card",
        emphasis: "La tarjeta es la opcion principal.",
        body: "Puedes usar tarjeta en:",
        bullets: [
          "Hoteles y alojamientos",
          "Restaurantes y cafes",
          "Centros comerciales y tiendas de conveniencia",
          "Transporte publico (T-money, etc.)",
        ],
      },
      {
        title: "Consejo util",
        icon: "spark",
        emphasis: "Las tarjetas de credito suelen funcionar con mas facilidad.",
        body:
          "Si tienes credito y debito, lleva ambas, pero espera usar credito como metodo principal.",
      },
      {
        title: "Que puede sorprenderte",
        icon: "alert",
        emphasis: "Algunos lugares solo aceptan efectivo.",
        body: "Suele pasar en:",
        bullets: [
          "Restaurantes locales pequenos",
          "Mercados tradicionales",
          "Puestos de comida callejera",
        ],
      },
      {
        title: "Cuanto efectivo necesitas realmente?",
        icon: "wallet",
        emphasis: "Normalmente, poco.",
        body: "El efectivo se usa sobre todo para:",
        bullets: [
          "Comida callejera",
          "Mercados",
          "Tiendas pequenas",
        ],
      },
      {
        title: "Donde sacar efectivo",
        icon: "pin",
        emphasis: "Hay cajeros por todas partes.",
        body: "Encontraras cajeros en:",
        bullets: [
          "Tiendas de conveniencia",
          "Estaciones de metro",
          "Bancos en zonas urbanas",
        ],
      },
      {
        title: "Lo que no hace falta complicar",
        icon: "hand",
        emphasis: "Mantenlo simple.",
        body: "No necesitas:",
        bullets: [
          "Cuenta bancaria local especial",
          "Apps de pago complicadas",
          "Grandes cantidades de efectivo",
        ],
      },
      {
        title: "Errores comunes con pagos",
        icon: "alert",
        emphasis: "El equilibrio es la clave.",
        body: "Muchos viajeros:",
        bullets: [
          "Dependen solo del efectivo",
          "Llevan mas efectivo del necesario",
          "Suponen que la debito extranjera funciona en todos lados",
        ],
      },
      {
        title: "La configuracion inteligente y sin estres",
        icon: "checklist",
        emphasis: "Tarjeta + poco efectivo",
        body: "Para la mayoria de viajeros:",
        bullets: [
          "Usa una tarjeta internacional para pagos principales",
          "Lleva una pequena cantidad de efectivo como respaldo",
        ],
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Si no piensas en el dinero, lo estas haciendo bien.",
        body:
          "Pagar en Corea es facil una vez que llegas. Mantenlo simple y sin estres.",
      },
    ],
  },
  "basic-korean-etiquette": {
    title: "Etiqueta coreana basica: reglas simples para viajeros",
    description:
      "Etiqueta coreana practica para visitantes. Aprende los pequenos habitos que evitan momentos incomodos - saludos, normas en espacios publicos, modales al comer y \"reglas no escritas\" culturales.",
    quickAnswer:
      "La etiqueta coreana se basa menos en \"reglas estrictas\" y mas en respeto, consideracion silenciosa y leer la situacion. No necesitas ser perfecto. Solo necesitas evitar los malentendidos mas comunes.",
    content: [
      {
        title: "ðŸ§­ Quick Overview",
        body:
          "La etiqueta coreana se basa menos en \"reglas estrictas\" y mas en respeto, consideracion silenciosa y leer la situacion.",
        tail:
          "No necesitas ser perfecto. Solo necesitas evitar los malentendidos mas comunes.",
      },
      {
        title: "ðŸ‘‹ 1. Saludos y primeras impresiones",
        body:
          "Un pequeno gesto hace que las interacciones sean mas fluidas. Una leve inclinacion de cabeza es normal cuando:",
        bullets: [
          "conocer a alguien por primera vez",
          "dar las gracias",
          "interactuar con personal en tiendas, hoteles y restaurantes",
        ],
        tail:
          "No necesitas una reverencia profunda. Un gesto breve y respetuoso es suficiente.",
      },
      {
        title: "ðŸ·ï¸ 2. Nombres, titulos y como dirigirte a otras personas",
        body:
          "Los nombres se manejan de forma distinta que en muchas culturas occidentales. En Corea suele evitarse llamar a alguien solo por su nombre (sobre todo al principio).",
        subsections: [
          {
            title: "Un patron seguro y comun es:",
            plainTitle: true,
            bullets: [
              "Nombre + \"ì”¨\" (ssi)",
              "Nombre + \"ë‹˜\" (nim)",
            ],
          },
          {
            title: "Si tienes dudas, tambien puedes evitar nombres y usar:",
            plainTitle: true,
            bullets: [
              "\"Perdon\" + tono educado",
              "\"Gracias\" (ê°ì‚¬í•©ë‹ˆë‹¤)",
            ],
          },
        ],
        tail:
          "Esto es mas importante en contextos formales o en primeros encuentros.",
      },
      {
        title: "ðŸš‡ 3. Etiqueta en espacios publicos",
        body: "El silencio y el orden se valoran mucho.",
        subsections: [
          {
            title: "En espacios publicos (sobre todo en transporte), lo mejor es:",
            plainTitle: true,
            bullets: [
              "mantener la voz baja",
              "evitar videos en altavoz",
              "mantener llamadas cortas",
            ],
          },
          {
            title: "La cultura de hacer fila es estricta y clara en Corea:",
            plainTitle: true,
            bullets: [
              "autobuses, cajas de pago, ascensores, cafeterias populares",
              "Colarse en la fila suele verse muy negativamente.",
            ],
          },
        ],
      },
      {
        title: "ðŸ½ï¸ 4. Etiqueta en la mesa",
        body:
          "Habitos simples evitan los momentos incomodos mas comunes.",
        subsections: [
          {
            title: "Lo basico:",
            plainTitle: true,
            bullets: [
              "Si hay personas mayores en la mesa, espera un momento antes de empezar",
              "No claves los palillos en vertical dentro del arroz (simbolismo ritual)",
              "Los platillos compartidos son normales en Corea",
              "El agua suele ser gratis y muchas veces autoservicio",
              "Muchos restaurantes usan boton de llamada en la mesa (no hace falta hacer senas)",
            ],
          },
          {
            title: "La cultura de pago suele diferir de paises con servicio en mesa:",
            plainTitle: true,
            bullets: ["Es comun pagar en el mostrador"],
          },
        ],
      },
      {
        title: "ðŸ‘Ÿ 5. Zapatos y cultura en interiores",
        body: "Si los locales se quitan los zapatos, tu tambien deberias hacerlo.",
        subsections: [
          {
            title: "Puede que debas quitarte los zapatos en:",
            plainTitle: true,
            bullets: [
              "casas",
              "algunos restaurantes tradicionales",
              "hanok stays y algunas guesthouses",
            ],
          },
        ],
        tail:
          "Si ves zapateros o personas en calcetines dentro, esa es la senal.",
      },
      {
        title: "â™»ï¸ 6. Basura, reciclaje y habitos en la calle",
        body:
          "Corea puede sentirse muy limpia, pero hay menos papeleras de lo que parece.",
        subsections: [
          {
            title: "Es normal:",
            plainTitle: true,
            bullets: [
              "llevar basura pequena hasta encontrar un basurero",
              "tirarla en tiendas de conveniencia o en tu alojamiento",
            ],
          },
        ],
        tail:
          "Las reglas de reciclaje son relativamente estrictas. Como visitante, sigue las etiquetas de los basureros publicos cuando esten disponibles.",
      },
      {
        title: "ðŸ“¸ 7. Etiqueta de fotos y privacidad",
        body: "Ten cuidado con los rostros de personas desconocidas.",
        bullets: [
          "Evita grabar o fotografiar desconocidos de cerca de forma casual.",
          "Dentro de tiendas o cafes, es mas seguro pedir permiso antes de tomar fotos.",
        ],
        tail:
          "Tambien ten en cuenta: algunas zonas relacionadas con instalaciones militares o lugares gubernamentales sensibles pueden tener restricciones de fotografia.",
      },
      {
        title: "ðŸ’³ 8. Dinero, pagos y propinas",
        body: "En Corea no se espera propina.",
        subsections: [
          {
            title: "En la mayoria de los casos:",
            plainTitle: true,
            bullets: [
              "los cargos de servicio ya estan incluidos",
              "dejar propina puede incomodar al personal",
              "El pago con tarjeta es extremadamente comun, incluso para compras pequenas.",
            ],
          },
        ],
      },
      {
        title: "ðŸ§˜ 9. Tono emocional y estilo de conflicto",
        body: "En Corea generalmente se evita la confrontacion publica.",
        subsections: [
          {
            title: "Si algo sale mal, normalmente es mejor:",
            plainTitle: true,
            bullets: [
              "hablar con calma",
              "preguntar al personal en voz baja",
              "evitar levantar la voz en publico",
            ],
          },
        ],
        tail:
          "La comunicacion educada y constante suele conseguir mejor ayuda.",
      },
      {
        title: "âš ï¸ 10. Temas sensibles que conviene evitar",
        body: "Algunos temas pueden volverse incomodos rapidamente.",
        subsections: [
          {
            title: "Es mas seguro evitar:",
            plainTitle: true,
            bullets: [
              "bromas sobre Corea del Norte",
              "comentarios casuales sobre el servicio militar",
              "debates politicos acalorados",
              "disputas historicas sensibles",
            ],
          },
        ],
        tail:
          "Aunque algunas personas los comenten, los visitantes deberian abordarlos con cuidado.",
      },
      {
        title: "âœ… Consejo final",
        body: "No necesitas \"actuar\" la cultura coreana.",
        subsections: [
          {
            title: "Si recuerdas tres principios, estara bien:",
            plainTitle: true,
            bullets: [
              "habla mas bajo de lo que crees necesario",
              "respeta filas y normas de espacios compartidos",
              "muestra respeto con pequenos gestos",
            ],
          },
        ],
        tail:
          "La mayoria de los locales no espera que los turistas sepan todo. Notan mas el esfuerzo que la perfeccion.",
      },
    ],
  },
  "korea-travel-safety": {
    title: "Corea es segura?",
    description: "Lo que los viajeros deben saber.",
    quickAnswer:
      "Esta pagina te ayuda a entender expectativas reales de seguridad para viajeros.",
    content: [
      {
        title: "Corea es segura?",
        icon: "shield",
        emphasis: "Si, Corea en general es muy segura.",
        body:
          "Pero 'segura' no significa bajar totalmente la guardia. Esta guia te ayuda a entender que significa seguridad real para viajeros en Corea.",
      },
      {
        title: "Por que muchos se sienten seguros desde el primer dia",
        icon: "spark",
        emphasis: "Comodidad desde el inicio.",
        body: "Muchos viajeros notan:",
        bullets: [
          "Personas caminando solas de noche",
          "Transporte publico funcionando hasta tarde",
          "Calles iluminadas y activas",
          "Delitos violentos poco comunes en zonas turisticas",
        ],
      },
      {
        title: "Donde conviene mantener atencion",
        icon: "alert",
        emphasis: "Los lugares llenos pueden ser abrumadores.",
        body: "Manten atencion basica en:",
        bullets: [
          "Subtes concurridos",
          "Zonas de vida nocturna",
          "Calles turisticas de compras",
        ],
      },
      {
        title: "Moverte de noche: que esperar",
        icon: "route",
        emphasis: "Seguro, activo y confiable.",
        body: "En la practica:",
        bullets: [
          "Subte y buses son seguros",
          "Los taxis son confiables",
          "Las zonas de comida nocturna estan activas",
          "Si sales tarde, usa calles bien iluminadas y mantente atento",
        ],
      },
      {
        title: "Habitos simples de seguridad",
        icon: "hand",
        emphasis: "Viaja comodo y seguro.",
        body: "Habitos utiles:",
        bullets: [
          "Usa calles principales",
          "Evita callejones vacios por la noche",
          "Toma un taxi si te sientes cansado o inseguro",
        ],
      },
      {
        title: "Preocupaciones comunes que no son problema",
        icon: "spark",
        emphasis: "Diferencias culturales, no peligro.",
        body: "En Corea es normal:",
        bullets: [
          "Que la gente mire por curiosidad",
          "Silencio en transporte publico",
          "Menos policia visible de la que esperas",
        ],
      },
      {
        title: "Cuando conviene tener cuidado extra",
        icon: "alert",
        emphasis: "Conoce tus limites.",
        body: "Pon mas atencion si:",
        bullets: [
          "Bebes mas de la cuenta",
          "Te quedas muy tarde en zonas nocturnas",
          "Ignoras tu entorno",
        ],
      },
      {
        title: "Ayuda en emergencias",
        icon: "shield",
        emphasis: "Casi nunca necesaria, pero facil de usar.",
        body:
          "Los servicios de emergencia son rapidos y bien organizados. En muchos casos hay soporte en ingles.",
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Atento, pero sin estres.",
        body:
          "Corea es tan segura que no tendras que preocuparte constantemente. Un buen viaje empieza cuando te sientes tranquilo y confiado.",
      },
    ],
  },
  "travel-insurance-for-korea": {
    title: "Necesito seguro de viaje para Corea del Sur? (Guia 2026)",
    description:
      "El seguro no es obligatorio por ley para la mayoria de visitantes de corta estancia en 2026, pero si es muy recomendable.",
    quickAnswer:
      "El seguro no es obligatorio con viaje sin visa o K-ETA, pero la mayoria de viajeros compra una poliza basica porque la atencion medica no es gratuita para turistas.",
    content: [
      {
        title: "Necesito seguro de viaje para Corea del Sur? (Guia 2026)",
        icon: "shield",
        emphasis:
          "El seguro de viaje no es obligatorio por ley para la mayoria de visitantes de corta estancia en Corea del Sur en 2026.",
        body:
          "Sin embargo, la atencion medica no es gratuita para turistas. Si ocurre algo inesperado, debes pagar el costo total por tu cuenta. Corea del Sur tiene un sistema medico moderno y de alta calidad. Los hospitales son limpios, eficientes y bien equipados. Pero sin seguro, incluso una emergencia simple puede salir cara. Para la mayoria de viajeros internacionales, un seguro basico es una red de seguridad practica y asequible.",
      },
      {
        title: "Respuesta rapida",
        icon: "spark",
        emphasis: "El seguro no es obligatorio para entrar.",
        body: "Aun asi, la mayoria de viajeros decide comprarlo por proteccion financiera.",
        bullets: [
          "El seguro no es obligatorio para entrar a Corea del Sur con viaje sin visa o K-ETA.",
          "Sin embargo, la mayoria de viajeros decide comprarlo por proteccion financiera.",
          "Una poliza basica suele costar menos que una comida de restaurante por dia y puede evitar gastos inesperados altos.",
        ],
      },
      {
        title: "Cuanto cuesta la atencion medica en Corea del Sur?",
        icon: "wallet",
        emphasis:
          "Los turistas no estan cubiertos por el sistema nacional de seguro medico de Corea.",
        body: "Costos de bolsillo habituales en 2026:",
        bullets: [
          "Consulta ambulatoria: 30-80 USD",
          "Urgencias en Seul: 300-800 USD",
          "Hospitalizacion (por noche): 1,000-3,000+ USD",
          "TC, RM, analisis de sangre: cargos adicionales",
          "Servicio de ambulancia: varia segun la situacion",
          "Las clinicas privadas internacionales pueden cobrar mas que los hospitales publicos.",
          "Son estimaciones generales. El costo real depende de la ubicacion, el tipo de hospital y el tratamiento necesario.",
        ],
      },
      {
        title: "Cuando se exige seguro de viaje?",
        icon: "passport",
        emphasis:
          "Para la mayoria de turistas de corta estancia, el seguro no es obligatorio para entrar a Corea del Sur.",
        body: "Sin embargo, puede exigirse en estos casos:",
        bullets: [
          "Ciertas categorias de visa",
          "Programas de estudio o intercambio",
          "Visas working holiday",
          "Algunas estancias patrocinadas por empleador",
          "Siempre revisa los requisitos oficiales de visa para tu nacionalidad antes de viajar.",
        ],
      },
      {
        title: "Cuando se recomienda seguro de viaje?",
        icon: "checklist",
        emphasis: "Se recomienda para la mayoria de visitantes.",
        body: "Es especialmente util si:",
        bullets: [
          "Viajas en invierno (las aceras heladas aumentan el riesgo de lesiones)",
          "Planeas senderismo, esqui u otras actividades al aire libre",
          "Tienes vuelos con conexion o de larga distancia",
          "Quieres proteccion por cancelacion de viaje o retraso de equipaje",
          "Incluso en un pais seguro como Corea del Sur, pueden ocurrir imprevistos.",
        ],
      },
      {
        title: "Que debe cubrir una buena poliza?",
        icon: "shield",
        emphasis:
          "Para viajar a Corea del Sur en 2026, una poliza practica deberia incluir:",
        body: "Busca estos puntos clave:",
        bullets: [
          "Cobertura medica de emergencia (al menos 50,000-100,000 USD)",
          "Hospitalizacion y ambulancia",
          "Cobertura por retraso o cancelacion del viaje",
          "Cobertura por equipaje perdido, robado o retrasado",
          "Asistencia de emergencia 24 horas en ingles",
          "Si planeas actividades de aventura, confirma cobertura para deportes de invierno o senderismo.",
        ],
      },
      {
        title: "Que no suele estar cubierto?",
        icon: "alert",
        emphasis: "Las polizas estandar suelen excluir:",
        body: "Lee siempre los detalles de la poliza antes de comprar.",
        bullets: [
          "Condiciones medicas preexistentes",
          "Deportes de alto riesgo (si no agregas cobertura extra)",
          "Reclamos sin documentacion adecuada",
          "Cancelaciones por motivos no medicos",
        ],
      },
      {
        title: "Situaciones comunes que enfrentan los viajeros",
        icon: "spark",
        emphasis: "La mayoria de reclamos no son emergencias graves.",
        body: "Normalmente se trata de:",
        bullets: [
          "Intoxicacion alimentaria",
          "Resbalones en calles heladas",
          "Accidentes de trafico menores",
          "Gripe fuerte o infecciones respiratorias",
          "Equipaje perdido o vuelos retrasados",
          "Son problemas normales de viaje que pueden pasar en cualquier lugar.",
        ],
      },
      {
        title: "Cuanto cuesta el seguro de viaje para Corea del Sur?",
        icon: "wallet",
        emphasis: "El seguro de viaje suele ser asequible.",
        body: "Para viajeros sanos de 20 a 40 anos:",
        bullets: [
          "1 semana: aprox. 15-40 USD",
          "2 semanas: aprox. 30-70 USD",
          "Los precios cambian segun edad, pais de residencia, duracion del viaje y nivel de cobertura.",
        ],
      },
      {
        title: "Reflexion final",
        icon: "spark",
        emphasis: "Corea del Sur es un destino seguro y muy desarrollado.",
        body:
          "La mayoria de viajeros nunca necesita usar su seguro de viaje, y eso es ideal. El seguro simplemente reduce el riesgo financiero. Para muchos visitantes, el costo es pequeno frente al presupuesto total del viaje y aporta tranquilidad desde la llegada hasta la salida.",
      },
    ],
  },
};

const localizeEsNode = (node?: TreeNode): TreeNode | undefined => {
  if (!node) return undefined;
  const override = ES_LEAF_OVERRIDES[node.slug];
  const children = node.children
    ? node.children.map((child) => localizeEsNode(child) ?? child)
    : undefined;
  if (!override) {
    if (!children) return node;
    return {
      ...node,
      children,
    };
  }
  return {
    ...node,
    ...override,
    content: override.content ?? node.content,
    children,
  };
};

const localizeEsLabel = (node: TreeNode): string =>
  ES_LEAF_OVERRIDES[node.slug]?.title ?? node.title;

export const getStaticPaths = () => {
  const paths: string[] = [];
  const HIDDEN_HUBS = new Set(["shopping-and-deals"]);
  const walk = (node: TreeNode, prefix: string[] = []) => {
    if (!node.children) return;
    for (const child of node.children) {
      const next = [...prefix, child.slug];
      const nextPath = next.join("/");
      if (!HIDDEN_HUBS.has(nextPath)) {
        paths.push(nextPath);
      }
      walk(child, next);
    }
  };
  walk(siteTree);
  return paths.map((slug) => ({ params: { slug } }));
};

const { slug } = Astro.params;
const segments = slug ? slug.split("/") : [];
const lang = "es";
const { node: rawNode } = findNodeBySegments(segments);
const node = localizeEsNode(rawNode);
if (!node) {
  Astro.response.status = 404;
}
const parentPath = segments.length > 1 ? getPathForNode(segments.slice(0, -1)) : "/";
const breadcrumbs: { label: string; path: string }[] = [];
let cursor = siteTree;
let pathSegments: string[] = [];
for (const segment of segments) {
  const next = cursor.children?.find((child) => child.slug === segment);
  if (!next) break;
  pathSegments = [...pathSegments, segment];
  breadcrumbs.push({
    label: localizeEsLabel(next),
    path: withLang(`/${pathSegments.join("/")}`, lang),
  });
  cursor = next;
}

const siteName = "Visit Korea Planner";
const notFound = "Page Not Found";
const notFoundDesc = "The page you are looking for does not exist.";
const ROUTE_META_DESCRIPTION_OVERRIDES: Record<string, string> = {
  "/plan-your-trip":
    "Duracion, ritmo y flujo entre ciudades en 7-14 dias. Arma un plan realista para Corea en unos 10 minutos.",
  "/choose-a-city":
    "Compara Seul, Busan, Jeju y mas en 5 minutos. Elige ciudad segun estilo de viaje, ritmo y traslados.",
  "/getting-around-korea":
    "Metro, bus, taxi y tarjetas de transporte en 7 minutos. Un viaje basico de metro suele empezar cerca de 1,400 KRW.",
  "/what-to-eat":
    "Comida coreana facil para empezar en 5 minutos. Prueba 5-7 platos base antes de elegir opciones picantes.",
  "/where-to-stay":
    "Elige zona y tipo de alojamiento en 8 minutos. Un hotel de rango medio suele costar aprox. 80,000-180,000 KRW por noche.",
  "/things-to-do":
    "Atracciones clave, planes por ciudad y costos en 7 minutos. Muchos lugares populares van de gratis a 20,000 KRW.",
  "/travel-basics":
    "SIM/eSIM, tarjeta o efectivo y seguridad en Corea, explicado en 5 minutos. Un plan SIM tipico cuesta aprox. 15,000-30,000 KRW.",
  "/before-you-go":
    "Entrada, documentos y llegada al aeropuerto en 6 minutos. Ten listos 3 basicos: pasaporte, reservas y requisitos de entrada.",
  "/shopping-and-deals":
    "Zonas de compras, tax refund y descuentos en 6 minutos. La elegibilidad y el monto del reembolso cambian segun tienda y compra.",
  "/latest-travel-updates-for-korea":
    "Actualizado para 2026. Revisa requisitos de entrada, K-ETA, aeropuerto, transporte y clima antes de reservar o volar.",
  "/korea-now-and-more":
    "Contexto semanal de Corea en unos 5 minutos. Te ayuda a ajustar el plan segun el momento local.",
  "/this-week-in-korea":
    "Corea esta semana en unos 2 minutos. Punto rapido de control antes de salir y durante el viaje.",
};
const ROUTE_META_TITLE_OVERRIDES: Record<string, string> = {
  "/latest-travel-updates-for-korea":
    "Actualizaciones de Viaje a Corea 2026: Entrada, K-ETA y Aeropuerto",
};
const routePath = segments.length ? `/${segments.join("/")}` : "/";
const routePathWithSlash = routePath === "/" ? "/" : `${routePath}/`;
const pageDescription =
  (node ? ROUTE_META_DESCRIPTION_OVERRIDES[routePath] : undefined) ??
  node?.description ??
  notFoundDesc;
const canonicalPath = withLang(routePath, lang);
const canonicalUrl = absoluteUrl(
  canonicalPath === "/" ? "/" : `${canonicalPath.replace(/\/+$/, "")}/`
);
const alternateEnUrl = absoluteUrl(routePathWithSlash);
const alternateEsUrl = canonicalUrl;

const pageTitle = node
  ? `${ROUTE_META_TITLE_OVERRIDES[routePath] ?? node.title} | ${siteName}`
  : `${notFound} | ${siteName}`;

const bodyClass = node ? (node.children && node.children.length > 0 ? "page--sub" : "page--leaf") : "page--sub";
const nodeForRender = node
  ? {
      ...node,
      updatedIso: getPageUpdatedIso(routePath, lang, node.updatedIso),
      quickAnswer: node.children?.length ? node.quickAnswer : buildLeafQuickAnswer(node, lang),
    }
  : undefined;
const schemaNodes = node
  ? nodeForRender!.children && nodeForRender!.children.length > 0
    ? buildCollectionSchemaNodes({
        canonicalUrl,
        routePath,
        node: nodeForRender!,
        lang,
        description: pageDescription,
      })
    : buildLeafSchemaNodes({
        canonicalUrl,
        node: nodeForRender!,
        lang,
        description: pageDescription,
        segments,
      })
  : [];
---

{node ? (
  <BaseLayout
    title={pageTitle}
    description={pageDescription}
    bodyClass={bodyClass}
    lang={lang}
    canonicalUrl={canonicalUrl}
    alternateEnUrl={alternateEnUrl}
    alternateEsUrl={alternateEsUrl}
    breadcrumbs={breadcrumbs}
    schemaNodes={schemaNodes}
    updatedIso={nodeForRender.updatedIso}
  >
    <TreePage
      node={nodeForRender}
      segments={segments}
      parentPath={withLang(parentPath, lang)}
      isHome={segments.length === 0}
      breadcrumbs={breadcrumbs}
      lang={lang}
    />
  </BaseLayout>
) : (
  <BaseLayout
    title={pageTitle}
    description={pageDescription}
    bodyClass="page--leaf"
    lang={lang}
    canonicalUrl={canonicalUrl}
    alternateEnUrl={alternateEnUrl}
    alternateEsUrl={alternateEsUrl}
    breadcrumbs={breadcrumbs}
    schemaNodes={schemaNodes}
    noindex
  >
    <section style="padding: 64px 0; text-align: center;">
      <h1 class="t-h1" style="font-family: Fraunces, serif;">{notFound}</h1>
      <p class="t-subheading" style="color: #5f6b84;">{notFoundDesc}</p>
      <a
        href={withLang("/", lang)}
        style="display: inline-flex; margin-top: 18px; padding: 10px 18px; border-radius: 999px; background: #1f6f8b; color: #fff;"
      >
        Go Home
      </a>
    </section>
  </BaseLayout>
)}
