---
import BaseLayout from "../../layouts/BaseLayout.astro";
import TreePage from "../../components/TreePage.astro";
import type { TreeNode } from "../../data/siteTree";
import { findNodeBySegments, getPathForNode, siteTree } from "../../data/siteTree";
import { buildCollectionSchemaNodes, buildLeafSchemaNodes } from "../../lib/geo";
import { withLang } from "../../lib/i18n";
import { getPageUpdatedIso } from "../../lib/page-updates";
import { absoluteUrl } from "../../lib/site";

type NodeContentBlock = NonNullable<TreeNode["content"]>[number];

const ES_LEAF_OVERRIDES: Record<
  string,
  Partial<Pick<TreeNode, "title" | "description" | "quickAnswer" | "updatedIso">> & {
    content?: NodeContentBlock[];
  }
> = {
  "travel-basics": {
    title: "Basicos de Viaje",
    description: "Internet, pagos y seguridad con menos estres.",
    quickAnswer:
      "Enfocate en 3 basicos: internet, pagos y seguridad. En unos 5 minutos puedes decidir lo esencial y viajar con menos estres.",
  },
  "is-getting-around-hard": {
    title: "Es dificil moverse por Corea del Sur?",
    updatedIso: "2026-02-18T00:00:00.000Z",
    description:
      "Que tan facil es realmente usar el transporte publico en Corea del Sur.",
    quickAnswer:
      "Esta pagina explica por que moverse por Corea del Sur es facil, incluso si es tu primera vez.",
    content: [
      {
        title: "Es dificil moverse por Corea del Sur?",
        icon: "train",
        emphasis: "Para la mayoria de viajeros, es mucho mas facil de lo que esperan.",
        body:
          "Corea del Sur tiene uno de los sistemas de transporte publico mas eficientes de Asia. Trenes, metro y buses son limpios, puntuales y pensados para viajeros diarios, por eso funcionan con mucha frecuencia durante todo el dia.",
      },
      {
        title: "Respuesta corta",
        icon: "spark",
        emphasis: "No. Es simple, confiable y amigable para turistas.",
        body: "La mayoria de visitantes nota rapido:",
        bullets: [
          "Trenes de metro cada 2-5 minutos en ciudades grandes como Seul y Busan",
          "Nombres de estaciones en ingles y salidas numeradas",
          "Tarifas accesibles por distancia (calculadas de forma automatica)",
          "Transbordos faciles entre metro y bus",
          "No hace falta alquilar auto en ciudades grandes",
          "Si te alojas en una zona centrica, el transporte publico suele ser mas rapido y predecible que manejar.",
        ],
      },
      {
        title: "Por que el transporte en Corea funciona tan bien",
        icon: "route",
        emphasis: "Todo esta conectado en un solo sistema.",
        body:
          "Metro, buses urbanos, tren al aeropuerto y trenes regionales usan una red integrada de tarifas. La tarjeta recargable T-money funciona en todo el pais: metro, buses, muchos taxis e incluso tiendas de conveniencia.",
        bullets: [
          "Para viajes entre ciudades, KTX (Korea Train Express), operado por Korail, conecta ciudades principales con rapidez. De Seul a Busan tardas aprox. 2.5 horas.",
          "Para traslados desde o hacia el aeropuerto, AREX (Airport Railroad Express) conecta el centro de Seul con Incheon International Airport de forma directa, rapida y confiable.",
        ],
      },
      {
        title: "Lo que suele preocupar a quienes viajan por primera vez",
        icon: "alert",
        emphasis: "La buena noticia: el sistema esta pensado para visitantes internacionales.",
        body: "Estas preocupaciones son comunes:",
        bullets: [
          "\"Y si no puedo leer coreano?\"",
          "\"Y si tomo el tren equivocado?\"",
          "\"Y si me pierdo bajo tierra?\"",
        ],
      },
      {
        title: "Lo que pasa en la practica",
        icon: "shield",
        emphasis: "Equivocarse es facil de corregir.",
        body: "En la vida real:",
        bullets: [
          "Las lineas del metro tienen color y numero",
          "Las estaciones muestran nombres en ingles con claridad",
          "Los anuncios suelen estar en coreano e ingles (a menudo tambien en chino y japones)",
          "Si vas en direccion equivocada, bajas en la siguiente parada y cambias de anden",
          "Para navegar, Naver Map y KakaoMap muestran rutas de transporte en tiempo real. Google Maps ayuda en metro, pero las apps locales son mejores para buses y transbordos.",
        ],
      },
      {
        title: "Como se mueve la mayoria de viajeros",
        icon: "train",
        emphasis: "Una mezcla simple de transportes suele funcionar mejor.",
        body: "La mayoria usa:",
        bullets: [
          "Metro para distancias largas y atracciones principales",
          "Buses urbanos para rutas de barrio",
          "Taxis de noche o cuando llevan equipaje pesado",
          "Los taxis en Corea suelen ser mas accesibles que en muchos paises occidentales. Puedes mostrar el destino en coreano desde tu app de mapas.",
        ],
      },
      {
        title: "Lo que no necesitas",
        icon: "hand",
        emphasis: "Descarga una app de transporte, consigue una T-money y listo.",
        body: "No necesitas:",
        bullets: [
          "Coreano fluido",
          "Mapas impresos en papel",
          "Alquilar auto en Seul o Busan",
          "Planificacion complicada de rutas",
        ],
      },
      {
        title: "Un error comun",
        icon: "alert",
        emphasis: "Pensar demasiado en el transporte.",
        body:
          "Algunas personas usan taxi demasiado por miedo a confundirse. En la practica, el metro suele ser mas rapido, sobre todo en hora pico cuando el trafico frena mucho a los autos.",
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Moverse por Corea del Sur es una de las partes mas faciles del viaje.",
        body:
          "Despues de tu primer viaje en metro, todo se vuelve claro y rutinario. Para la mayoria de viajeros, el transporte termina siendo una de las partes menos estresantes y mas eficientes del viaje.",
      },
    ],
  },
  "latest-travel-updates-for-korea": {
    title: "Ultimas Actualizaciones de Viaje para Corea",
    description: "Fuentes oficiales para confirmar antes de viajar.",
    quickAnswer:
      "Usa esta pagina como verificacion final antes de reservar o volar.",
    content: [
      {
        title: "Ultimas Actualizaciones de Viaje para Corea",
        icon: "shield",
        emphasis: "Fuentes oficiales para confirmar antes de viajar",
        body:
          "La informacion de viaje en Corea del Sur puede cambiar mas rapido que cualquier guia. Usa esta pagina como verificacion final antes de reservar o volar.",
        bullets: [
          "Primero planifica. Aqui confirmas. Viaja con confianza.",
        ],
      },
      {
        title: "Entrada e Inmigracion",
        icon: "passport",
        emphasis:
          "Las reglas de entrada y autorizacion dependen de tu nacionalidad y pueden cambiar sin aviso.",
        body: "Confirma siempre tu estado de entrada antes de salir.",
        bullets: [
          "K-ETA (sistema oficial de autorizacion) - Si tu pais esta exento de visa, solicita antes del viaje. https://www.k-eta.go.kr/portal/apply/index.do?locale=EN",
          "e-Arrival Card (formulario de llegada en linea) - Declaracion de llegada en linea (envio dentro de los 3 dias antes de llegar). https://www.e-arrivalcard.go.kr/portal/main/index.do?locale=EN",
          "Procedimientos de llegada e inmigracion - Incheon Airport: https://www.airport.kr/ap_en/1439/subview.do",
        ],
      },
      {
        title: "Transporte y Aeropuertos",
        icon: "train",
        emphasis:
          "Los horarios de tren, procesos de aeropuerto y precios de transporte pueden variar en feriados y temporadas altas.",
        body:
          "Los horarios de tren, procesos de aeropuerto y precios de transporte pueden variar en feriados y temporadas altas.",
        bullets: [
          "Incheon International Airport (ingles) - Procedimientos de llegada, info de terminal y opciones de transporte. https://www.airport.kr/sites/ap_en/index.do",
          "Seul - Llegar a Seul desde Incheon Airport (oficial) - Opciones oficiales de traslado (incluye AREX y buses limusina). https://english.seoul.go.kr/service/entry/getting-to-seoul-from-incheon-airport/",
          "Korail - Trenes de alta velocidad y regionales (KTX) - Horarios nacionales, rutas y tickets. https://www.korail.com/global/eng/intro",
          "AREX (Airport Railroad Express) - Tren entre Incheon y Seul. https://www.arex.or.kr (interfaz en ingles disponible)",
          "Transporte publico de Seul (pagina oficial en ingles). https://english.seoul.go.kr/service/movement/public-transportation/",
          "Transporte publico de Busan (pagina oficial en ingles). https://www.busan.go.kr/eng/public-transportation",
        ],
      },
      {
        title: "Clima y Condiciones por Temporada",
        icon: "cloud",
        emphasis:
          "El clima afecta mucho los planes de viaje, sobre todo en verano e invierno.",
        body:
          "El clima afecta mucho los planes de viaje, sobre todo en verano e invierno.",
        bullets: [
          "Korea Meteorological Administration (ingles) - Pronosticos oficiales y alertas meteorologicas. https://www.kma.go.kr/neng/index.do",
        ],
      },
      {
        title: "Organizaciones Oficiales de Turismo",
        icon: "pin",
        emphasis: "Horarios, festivales y cierres se actualizan por ciudad.",
        body: "Horarios, festivales y cierres se actualizan por ciudad.",
        bullets: [
          "Korea Tourism Organization - Informacion nacional para planear. https://english.visitkorea.or.kr/svc/main/index.do",
          "Seoul Tourism Organization (sitio oficial en ingles) - Atracciones, barrios, comida y compras. https://english.visitseoul.net",
          "Busan Tourism Organization - Informacion de ciudad y consejos. https://english.busan.go.kr",
          "Jeju Tourism Organization - Atracciones y eventos en Jeju. https://www.visitjeju.net/en",
          "Gyeongju Tourism - Sitios historicos e informacion cultural. https://www.gyeongju.go.kr/tour/index.do",
          "Jeonju Tourism - Sitio oficial de turismo y cultura. https://tour.jeonju.go.kr/eng",
        ],
      },
      {
        title: "Seguridad y Avisos de Viaje",
        icon: "alert",
        emphasis:
          "Corea del Sur suele ser muy segura, pero las fuentes oficiales te ayudan a mantenerte al dia.",
        body: "Numeros de emergencia (24/7): Policia 112, Bomberos / Ambulancia 119",
        bullets: [
          "Ministry of Foreign Affairs - Travel Notices (ingles): https://www.mofa.go.kr/eng/index.do",
          "Linea de ayuda oficial al turista en Corea (1330) con opcion en ingles.",
          "Tambien revisa el sitio de la embajada de tu pais en Corea para apoyo consular.",
        ],
      },
      {
        title: "Pagos, Compras y Tax Refund",
        icon: "wallet",
        emphasis:
          "Las reglas de tax refund y los metodos de pago cambian segun tienda y ubicacion.",
        body:
          "Las reglas de tax refund y los metodos de pago cambian segun tienda y ubicacion.",
        bullets: [
          "Global Tax Free Korea - Tiendas participantes y proceso de reembolso. https://www.global-taxfree.com/?lang=en#1",
          "Korea Customs Service (ingles) - Limites duty-free y reglas de declaracion. https://www.customs.go.kr/english/main.do",
        ],
      },
      {
        title: "Como usar esta pagina",
        icon: "spark",
        emphasis: "Decide destino y duracion, luego confirma aqui.",
        body:
          "Muchos viajeros vuelven a esta pagina unos dias antes de volar para evitar sorpresas de ultimo minuto.",
        bullets: [
          "Usa estas fuentes oficiales para confirmar reglas y condiciones actuales.",
          "Revisa de nuevo requisitos de entrada, clima, transporte y aeropuertos antes de salir.",
          "Antes de reservar planes no reembolsables, revisa seguro de viaje para Corea.",
        ],
      },
    ],
  },
  "sim-or-esim": {
    title: "SIM o eSIM?",
    description: "Opciones de internet explicadas de forma simple.",
    quickAnswer:
      "Esta pagina te ayuda a elegir la opcion de internet mas simple para tu telefono.",
    content: [
      {
        title: "SIM o eSIM?",
        icon: "sim",
        emphasis: "Corea es conocida por su internet rapido y confiable.",
        body:
          "Necesitaras una buena conexion para mapas, transporte, pagos y traducciones. La clave es elegir la opcion que mejor se adapte a ti.",
      },
      {
        title: "Respuesta rapida",
        icon: "checklist",
        emphasis: "Una sola eleccion resuelve casi todo.",
        body:
          "Si tu telefono admite eSIM, elige eSIM. Si no, usa una SIM fisica.",
      },
      {
        title: "Que es una eSIM?",
        icon: "sim",
        emphasis: "Digital, simple y rapida.",
        body: "Por que a los viajeros les gusta:",
        bullets: [
          "Puedes configurarla antes de llegar",
          "No necesitas ir a una tienda en el aeropuerto",
          "Puedes mantener activa tu SIM de origen para mensajes o banca",
        ],
      },
      {
        title: "Cuando conviene mas una SIM fisica",
        icon: "card",
        emphasis: "Compatibilidad y soporte.",
        body: "Una SIM fisica es mejor si:",
        bullets: [
          "Tu telefono es antiguo",
          "No estas seguro de la compatibilidad con eSIM",
          "Prefieres ayuda presencial",
          "Quieres comprarla en el aeropuerto o en un operador",
        ],
      },
      {
        title: "Lo que realmente necesitas",
        icon: "spark",
        emphasis: "Primero los datos.",
        body: "Para la mayoria de viajeros:",
        bullets: [
          "Los planes solo de datos suelen ser suficientes",
          "Datos ilimitados dan mas comodidad",
          "Los minutos de llamada casi nunca son necesarios",
        ],
      },
      {
        title: "Precios orientativos (SIM y eSIM en Corea)",
        icon: "wallet",
        emphasis: "Rangos comunes para viajeros.",
        body: "SIM fisica y plan eSIM:",
        bullets: [
          "SIM fisica - Precio: aprox. 20,000-30,000 KRW (5GB-10GB)",
          "SIM fisica - Donde comprar: aeropuertos, tiendas grandes y mostradores de operadoras",
          "SIM fisica - Operadoras: SK Telecom, KT, LG U+",
          "eSIM - Precio: aprox. 15,000-25,000 KRW (5GB-10GB)",
          "eSIM - Donde comprar: en linea antes del viaje y activar al llegar",
          "eSIM - Operadoras: SK Telecom, KT",
        ],
      },
      {
        title: "Errores comunes que debes evitar",
        icon: "alert",
        emphasis: "Revisa la compatibilidad primero.",
        body: "Antes de comprar, confirma:",
        bullets: [
          "Modelo de tu telefono",
          "Soporte eSIM",
          "Compatibilidad de red",
        ],
      },
      {
        title: "Debes decidir todo ahora?",
        icon: "checklist",
        emphasis: "Elige opcion primero, confirma detalles despues.",
        body: "Los precios y planes pueden cambiar. Verifica siempre en:",
        bullets: [
          "Sitios oficiales de telecom",
          "Mostradores de telecom en aeropuerto",
          "Vendedores autorizados",
        ],
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Conectado siempre es la clave.",
        body:
          "Elige eSIM por rapidez y simplicidad. Elige SIM fisica por compatibilidad y soporte presencial.",
      },
    ],
  },
  "how-to-pay-in-korea": {
    title: "Como pagar en Corea",
    description: "Tarjeta, efectivo y lo que realmente funciona.",
    quickAnswer:
      "Esta pagina te ayuda a entender que metodos de pago funcionan de verdad en Corea.",
    content: [
      {
        title: "Como pagar en Corea",
        icon: "wallet",
        emphasis: "Las tarjetas se aceptan en casi todo, pero el efectivo aun sirve.",
        body:
          "No necesitas preocuparte demasiado por los pagos. En Corea es simple: usa tarjeta para casi todo y lleva algo de efectivo como respaldo.",
      },
      {
        title: "Tarjetas: que funciona mejor",
        icon: "card",
        emphasis: "La tarjeta es la opcion principal.",
        body: "Puedes usar tarjeta en:",
        bullets: [
          "Hoteles y alojamientos",
          "Restaurantes y cafes",
          "Centros comerciales y tiendas de conveniencia",
          "Transporte publico (T-money, etc.)",
        ],
      },
      {
        title: "Consejo util",
        icon: "spark",
        emphasis: "Las tarjetas de credito suelen funcionar con mas facilidad.",
        body:
          "Si tienes credito y debito, lleva ambas, pero espera usar credito como metodo principal.",
      },
      {
        title: "Que puede sorprenderte",
        icon: "alert",
        emphasis: "Algunos lugares solo aceptan efectivo.",
        body: "Suele pasar en:",
        bullets: [
          "Restaurantes locales pequenos",
          "Mercados tradicionales",
          "Puestos de comida callejera",
        ],
      },
      {
        title: "Cuanto efectivo necesitas realmente?",
        icon: "wallet",
        emphasis: "Normalmente, poco.",
        body: "El efectivo se usa sobre todo para:",
        bullets: [
          "Comida callejera",
          "Mercados",
          "Tiendas pequenas",
        ],
      },
      {
        title: "Donde sacar efectivo",
        icon: "pin",
        emphasis: "Hay cajeros por todas partes.",
        body: "Encontraras cajeros en:",
        bullets: [
          "Tiendas de conveniencia",
          "Estaciones de metro",
          "Bancos en zonas urbanas",
        ],
      },
      {
        title: "Lo que no hace falta complicar",
        icon: "hand",
        emphasis: "Mantenlo simple.",
        body: "No necesitas:",
        bullets: [
          "Cuenta bancaria local especial",
          "Apps de pago complicadas",
          "Grandes cantidades de efectivo",
        ],
      },
      {
        title: "Errores comunes con pagos",
        icon: "alert",
        emphasis: "El equilibrio es la clave.",
        body: "Muchos viajeros:",
        bullets: [
          "Dependen solo del efectivo",
          "Llevan mas efectivo del necesario",
          "Suponen que la debito extranjera funciona en todos lados",
        ],
      },
      {
        title: "La configuracion inteligente y sin estres",
        icon: "checklist",
        emphasis: "Tarjeta + poco efectivo",
        body: "Para la mayoria de viajeros:",
        bullets: [
          "Usa una tarjeta internacional para pagos principales",
          "Lleva una pequena cantidad de efectivo como respaldo",
        ],
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Si no piensas en el dinero, lo estas haciendo bien.",
        body:
          "Pagar en Corea es facil una vez que llegas. Mantenlo simple y sin estres.",
      },
    ],
  },
  "is-korea-safe": {
    title: "Corea es segura?",
    description: "Lo que los viajeros deben saber.",
    quickAnswer:
      "Esta pagina te ayuda a entender expectativas reales de seguridad para viajeros.",
    content: [
      {
        title: "Corea es segura?",
        icon: "shield",
        emphasis: "Si, Corea en general es muy segura.",
        body:
          "Pero 'segura' no significa bajar totalmente la guardia. Esta guia te ayuda a entender que significa seguridad real para viajeros en Corea.",
      },
      {
        title: "Por que muchos se sienten seguros desde el primer dia",
        icon: "spark",
        emphasis: "Comodidad desde el inicio.",
        body: "Muchos viajeros notan:",
        bullets: [
          "Personas caminando solas de noche",
          "Transporte publico funcionando hasta tarde",
          "Calles iluminadas y activas",
          "Delitos violentos poco comunes en zonas turisticas",
        ],
      },
      {
        title: "Donde conviene mantener atencion",
        icon: "alert",
        emphasis: "Los lugares llenos pueden ser abrumadores.",
        body: "Manten atencion basica en:",
        bullets: [
          "Subtes concurridos",
          "Zonas de vida nocturna",
          "Calles turisticas de compras",
        ],
      },
      {
        title: "Moverte de noche: que esperar",
        icon: "route",
        emphasis: "Seguro, activo y confiable.",
        body: "En la practica:",
        bullets: [
          "Subte y buses son seguros",
          "Los taxis son confiables",
          "Las zonas de comida nocturna estan activas",
          "Si sales tarde, usa calles bien iluminadas y mantente atento",
        ],
      },
      {
        title: "Habitos simples de seguridad",
        icon: "hand",
        emphasis: "Viaja comodo y seguro.",
        body: "Habitos utiles:",
        bullets: [
          "Usa calles principales",
          "Evita callejones vacios por la noche",
          "Toma un taxi si te sientes cansado o inseguro",
        ],
      },
      {
        title: "Preocupaciones comunes que no son problema",
        icon: "spark",
        emphasis: "Diferencias culturales, no peligro.",
        body: "En Corea es normal:",
        bullets: [
          "Que la gente mire por curiosidad",
          "Silencio en transporte publico",
          "Menos policia visible de la que esperas",
        ],
      },
      {
        title: "Cuando conviene tener cuidado extra",
        icon: "alert",
        emphasis: "Conoce tus limites.",
        body: "Pon mas atencion si:",
        bullets: [
          "Bebes mas de la cuenta",
          "Te quedas muy tarde en zonas nocturnas",
          "Ignoras tu entorno",
        ],
      },
      {
        title: "Ayuda en emergencias",
        icon: "shield",
        emphasis: "Casi nunca necesaria, pero facil de usar.",
        body:
          "Los servicios de emergencia son rapidos y bien organizados. En muchos casos hay soporte en ingles.",
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Atento, pero sin estres.",
        body:
          "Corea es tan segura que no tendras que preocuparte constantemente. Un buen viaje empieza cuando te sientes tranquilo y confiado.",
      },
    ],
  },
  "solo-travel-safety": {
    title: "Seguridad para viajar solo",
    description: "Consejos para viajar por tu cuenta.",
    quickAnswer:
      "Esta pagina ayuda a viajeros solitarios a sentirse confiados y preparados en Corea.",
    content: [
      {
        title: "Seguridad para viajar solo",
        icon: "shield",
        emphasis: "Viajar solo en Corea es seguro, facil y comodo.",
        body:
          "Viajar por tu cuenta es comun aqui, y muchos viajeros en solitario se sienten mas tranquilos de lo esperado despues de pocos dias.",
      },
      {
        title: "Por que Corea funciona bien para viajeros solos",
        icon: "spark",
        emphasis: "Estructura clara y simple.",
        body: "Encontraras:",
        bullets: [
          "Transporte publico claro",
          "Calles y estaciones faciles de seguir",
          "Tiendas de conveniencia en todas partes",
          "Comer solo es totalmente normal",
        ],
      },
      {
        title: "Comer solo es normal",
        icon: "bowl",
        emphasis: "En Corea no es raro comer sin compania.",
        body: "En Corea:",
        bullets: [
          "Cafes y restaurantes reciben bien a clientes solos",
          "La comida de tienda de conveniencia suele ser de buena calidad",
          "Algunos BBQ prefieren grupos, pero hay muchas alternativas",
        ],
      },
      {
        title: "Moverte solo de dia y de noche",
        icon: "route",
        emphasis: "Confiable y seguro.",
        body: "Durante el dia:",
        bullets: [
          "El transporte publico es muy seguro",
          "Las zonas turisticas son activas y vigiladas",
          "Caminar solo se siente comodo",
        ],
      },
      {
        title: "Por la noche",
        icon: "spark",
        emphasis: "Las calles principales siguen activas.",
        body: "Por la noche:",
        bullets: [
          "Las calles principales siguen con movimiento",
          "Los taxis son faciles de usar",
          "Las zonas de comida nocturna siguen seguras y llenas de vida",
        ],
      },
      {
        title: "Habitos simples para mayor comodidad",
        icon: "checklist",
        emphasis: "Pequenos habitos ayudan mucho.",
        body: "Sugerencias utiles:",
        bullets: [
          "Guarda offline la direccion del hotel",
          "Lleva bateria externa",
          "Ubica la estacion de metro mas cercana",
        ],
      },
      {
        title: "Lo que a veces se sobrepiensa",
        icon: "hand",
        emphasis: "Es cultural, no personal.",
        body: "Podrias notar:",
        bullets: [
          "Subtes silenciosos",
          "Menos sonrisas de desconocidos",
          "Menos charla casual",
        ],
      },
      {
        title: "Cuando tener precaucion extra",
        icon: "alert",
        emphasis: "Escucha tu energia.",
        body: "Ten mas cuidado si:",
        bullets: [
          "Bebes mas de lo normal",
          "Te quedas muy tarde en zonas de fiesta",
          "Te sientes cansado o desorientado",
        ],
      },
      {
        title: "Por que viajar solo aqui se siente empoderador",
        icon: "spark",
        emphasis: "La confianza crece rapido.",
        body: "Muchos viajeros solos dicen que Corea les ayuda a:",
        bullets: [
          "Viajar a su propio ritmo",
          "Moverse con confianza",
          "Disfrutar momentos tranquilos sin presion",
        ],
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Comodidad, atencion y facilidad.",
        body:
          "Si te sientes tranquilo explorando por tu cuenta, lo estas haciendo bien.",
      },
    ],
  },
  "in-case-of-emergency": {
    title: "En caso de emergencia",
    description: "Que hacer y a quien llamar.",
    quickAnswer:
      "Esta pagina te ayuda a saber que hacer rapido si algo sale mal.",
    content: [
      {
        title: "En caso de emergencia",
        icon: "alert",
        emphasis: "Manten la calma y sigue pasos simples.",
        body:
          "Las emergencias son poco frecuentes en Corea, pero estar preparado hace que todo sea mas facil de manejar.",
      },
      {
        title: "Primero, respira",
        icon: "shield",
        emphasis: "La ayuda llega rapido y es facil de acceder.",
        body:
          "Los servicios de emergencia en Corea estan bien organizados y acostumbrados a ayudar a extranjeros. No necesitas hablar coreano perfecto.",
      },
      {
        title: "Numeros de emergencia importantes",
        icon: "alert",
        emphasis: "Guardalos antes de viajar.",
        body: "Guardalos antes de viajar:",
        bullets: [
          "Policia: 112",
          "Bomberos/Medico: 119",
          "Funcionan en movil, telefonos publicos y hotel",
        ],
      },
      {
        title: "Si necesitas atencion medica",
        icon: "shield",
        emphasis: "Llama al 119 si es grave.",
        body: "Para casos no urgentes:",
        bullets: [
          "Ve a un hospital con personal que hable ingles",
          "Pide al hotel ayuda para explicar sintomas",
          "Visita una farmacia para problemas leves",
        ],
      },
      {
        title: "Si pierdes algo",
        icon: "passport",
        emphasis: "No entres en panico. Tiene solucion.",
        body: "Sigue estos pasos:",
        bullets: [
          "Ve a la comisaria mas cercana o pide ayuda en el hotel",
          "Reporta la perdida (es un proceso habitual)",
          "Contacta a tu embajada si hace falta",
        ],
      },
      {
        title: "Si te sientes inseguro",
        icon: "hand",
        emphasis: "Haz acciones simples.",
        body: "Si algo te incomoda:",
        bullets: [
          "Entra a una tienda de conveniencia o cafe cercano",
          "Toma taxi en lugar de caminar",
          "Llama a tu alojamiento para pedir ayuda",
        ],
      },
      {
        title: "Ayuda con el idioma en emergencias",
        icon: "sim",
        emphasis: "No estas solo.",
        body: "Si la comunicacion es dificil:",
        bullets: [
          "Usa una app de traduccion con voz",
          "Muestra direccion del hotel o reserva",
          "Pide apoyo al personal cercano",
        ],
      },
      {
        title: "Preocupaciones comunes",
        icon: "spark",
        emphasis: "Nadie te va a juzgar.",
        body:
          "En emergencias, el personal es paciente y espera errores. Ayudarte es su trabajo.",
      },
      {
        title: "Preparacion rapida, gran tranquilidad",
        icon: "checklist",
        emphasis: "Haz esto una vez.",
        body: "Haz esto una vez:",
        bullets: [
          "Guarda numeros de emergencia",
          "Haz captura de la direccion del hotel",
          "Lleva los datos de tu seguro de viaje",
          "Revisa costos hospitalarios en Corea para entender mejor el riesgo de pago directo.",
        ],
      },
      {
        title: "Conclusion",
        icon: "spark",
        emphasis: "Manten la calma. La ayuda esta cerca.",
        body:
          "En Corea no estas solo. Sea un problema pequeno o una emergencia, la ayuda suele estar a una llamada.",
      },
    ],
  },
  "travel-insurance-for-korea": {
    title: "Necesito seguro de viaje para Corea del Sur? (Guia 2026)",
    description:
      "El seguro no es obligatorio por ley para la mayoria de visitantes de corta estancia en 2026, pero si es muy recomendable.",
    quickAnswer:
      "El seguro no es obligatorio con viaje sin visa o K-ETA, pero la mayoria de viajeros compra una poliza basica porque la atencion medica no es gratuita para turistas.",
    content: [
      {
        title: "Necesito seguro de viaje para Corea del Sur? (Guia 2026)",
        icon: "shield",
        emphasis:
          "El seguro de viaje no es obligatorio por ley para la mayoria de visitantes de corta estancia en Corea del Sur en 2026.",
        body:
          "Sin embargo, la atencion medica no es gratuita para turistas. Si ocurre algo inesperado, debes pagar el costo total por tu cuenta. Corea del Sur tiene un sistema medico moderno y de alta calidad. Los hospitales son limpios, eficientes y bien equipados. Pero sin seguro, incluso una emergencia simple puede salir cara. Para la mayoria de viajeros internacionales, un seguro basico es una red de seguridad practica y asequible.",
      },
      {
        title: "Respuesta rapida",
        icon: "spark",
        emphasis: "El seguro no es obligatorio para entrar.",
        body: "Aun asi, la mayoria de viajeros decide comprarlo por proteccion financiera.",
        bullets: [
          "El seguro no es obligatorio para entrar a Corea del Sur con viaje sin visa o K-ETA.",
          "Sin embargo, la mayoria de viajeros decide comprarlo por proteccion financiera.",
          "Una poliza basica suele costar menos que una comida de restaurante por dia y puede evitar gastos inesperados altos.",
        ],
      },
      {
        title: "Cuanto cuesta la atencion medica en Corea del Sur?",
        icon: "wallet",
        emphasis:
          "Los turistas no estan cubiertos por el sistema nacional de seguro medico de Corea.",
        body: "Costos de bolsillo habituales en 2026:",
        bullets: [
          "Consulta ambulatoria: 30-80 USD",
          "Urgencias en Seul: 300-800 USD",
          "Hospitalizacion (por noche): 1,000-3,000+ USD",
          "TC, RM, analisis de sangre: cargos adicionales",
          "Servicio de ambulancia: varia segun la situacion",
          "Las clinicas privadas internacionales pueden cobrar mas que los hospitales publicos.",
          "Son estimaciones generales. El costo real depende de la ubicacion, el tipo de hospital y el tratamiento necesario.",
        ],
      },
      {
        title: "Cuando se exige seguro de viaje?",
        icon: "passport",
        emphasis:
          "Para la mayoria de turistas de corta estancia, el seguro no es obligatorio para entrar a Corea del Sur.",
        body: "Sin embargo, puede exigirse en estos casos:",
        bullets: [
          "Ciertas categorias de visa",
          "Programas de estudio o intercambio",
          "Visas working holiday",
          "Algunas estancias patrocinadas por empleador",
          "Siempre revisa los requisitos oficiales de visa para tu nacionalidad antes de viajar.",
        ],
      },
      {
        title: "Cuando se recomienda seguro de viaje?",
        icon: "checklist",
        emphasis: "Se recomienda para la mayoria de visitantes.",
        body: "Es especialmente util si:",
        bullets: [
          "Viajas en invierno (las aceras heladas aumentan el riesgo de lesiones)",
          "Planeas senderismo, esqui u otras actividades al aire libre",
          "Tienes vuelos con conexion o de larga distancia",
          "Quieres proteccion por cancelacion de viaje o retraso de equipaje",
          "Incluso en un pais seguro como Corea del Sur, pueden ocurrir imprevistos.",
        ],
      },
      {
        title: "Que debe cubrir una buena poliza?",
        icon: "shield",
        emphasis:
          "Para viajar a Corea del Sur en 2026, una poliza practica deberia incluir:",
        body: "Busca estos puntos clave:",
        bullets: [
          "Cobertura medica de emergencia (al menos 50,000-100,000 USD)",
          "Hospitalizacion y ambulancia",
          "Cobertura por retraso o cancelacion del viaje",
          "Cobertura por equipaje perdido, robado o retrasado",
          "Asistencia de emergencia 24 horas en ingles",
          "Si planeas actividades de aventura, confirma cobertura para deportes de invierno o senderismo.",
        ],
      },
      {
        title: "Que no suele estar cubierto?",
        icon: "alert",
        emphasis: "Las polizas estandar suelen excluir:",
        body: "Lee siempre los detalles de la poliza antes de comprar.",
        bullets: [
          "Condiciones medicas preexistentes",
          "Deportes de alto riesgo (si no agregas cobertura extra)",
          "Reclamos sin documentacion adecuada",
          "Cancelaciones por motivos no medicos",
        ],
      },
      {
        title: "Situaciones comunes que enfrentan los viajeros",
        icon: "spark",
        emphasis: "La mayoria de reclamos no son emergencias graves.",
        body: "Normalmente se trata de:",
        bullets: [
          "Intoxicacion alimentaria",
          "Resbalones en calles heladas",
          "Accidentes de trafico menores",
          "Gripe fuerte o infecciones respiratorias",
          "Equipaje perdido o vuelos retrasados",
          "Son problemas normales de viaje que pueden pasar en cualquier lugar.",
        ],
      },
      {
        title: "Cuanto cuesta el seguro de viaje para Corea del Sur?",
        icon: "wallet",
        emphasis: "El seguro de viaje suele ser asequible.",
        body: "Para viajeros sanos de 20 a 40 anos:",
        bullets: [
          "1 semana: aprox. 15-40 USD",
          "2 semanas: aprox. 30-70 USD",
          "Los precios cambian segun edad, pais de residencia, duracion del viaje y nivel de cobertura.",
        ],
      },
      {
        title: "Reflexion final",
        icon: "spark",
        emphasis: "Corea del Sur es un destino seguro y muy desarrollado.",
        body:
          "La mayoria de viajeros nunca necesita usar su seguro de viaje, y eso es ideal. El seguro simplemente reduce el riesgo financiero. Para muchos visitantes, el costo es pequeno frente al presupuesto total del viaje y aporta tranquilidad desde la llegada hasta la salida.",
      },
    ],
  },
};

const localizeEsNode = (node?: TreeNode): TreeNode | undefined => {
  if (!node) return undefined;
  const override = ES_LEAF_OVERRIDES[node.slug];
  const children = node.children
    ? node.children.map((child) => localizeEsNode(child) ?? child)
    : undefined;
  if (!override) {
    if (!children) return node;
    return {
      ...node,
      children,
    };
  }
  return {
    ...node,
    ...override,
    content: override.content ?? node.content,
    children,
  };
};

const localizeEsLabel = (node: TreeNode): string =>
  ES_LEAF_OVERRIDES[node.slug]?.title ?? node.title;

export const getStaticPaths = () => {
  const paths: string[] = [];
  const walk = (node: TreeNode, prefix: string[] = []) => {
    if (!node.children) return;
    for (const child of node.children) {
      const next = [...prefix, child.slug];
      paths.push(next.join("/"));
      walk(child, next);
    }
  };
  walk(siteTree);
  return paths.map((slug) => ({ params: { slug } }));
};

const { slug } = Astro.params;
const segments = slug ? slug.split("/") : [];
const lang = "es";
const { node: rawNode } = findNodeBySegments(segments);
const node = localizeEsNode(rawNode);
if (!node) {
  Astro.response.status = 404;
}
const parentPath = segments.length > 1 ? getPathForNode(segments.slice(0, -1)) : "/";
const breadcrumbs: { label: string; path: string }[] = [];
let cursor = siteTree;
let pathSegments: string[] = [];
for (const segment of segments) {
  const next = cursor.children?.find((child) => child.slug === segment);
  if (!next) break;
  pathSegments = [...pathSegments, segment];
  breadcrumbs.push({
    label: localizeEsLabel(next),
    path: withLang(`/${pathSegments.join("/")}`, lang),
  });
  cursor = next;
}

const siteName = "Visit Korea Planner";
const notFound = "Page Not Found";
const notFoundDesc = "The page you are looking for does not exist.";
const ROUTE_META_DESCRIPTION_OVERRIDES: Record<string, string> = {
  "/plan-your-trip":
    "Duracion, ritmo y flujo entre ciudades en 7-14 dias. Arma un plan realista para Corea en unos 10 minutos.",
  "/choose-a-city":
    "Compara Seul, Busan, Jeju y mas en 5 minutos. Elige ciudad segun estilo de viaje, ritmo y traslados.",
  "/getting-around-korea":
    "Metro, bus, taxi y tarjetas de transporte en 7 minutos. Un viaje basico de metro suele empezar cerca de 1,400 KRW.",
  "/what-to-eat":
    "Comida coreana facil para empezar en 5 minutos. Prueba 5-7 platos base antes de elegir opciones picantes.",
  "/where-to-stay":
    "Elige zona y tipo de alojamiento en 8 minutos. Un hotel de rango medio suele costar aprox. 80,000-180,000 KRW por noche.",
  "/things-to-do":
    "Atracciones clave, planes por ciudad y costos en 7 minutos. Muchos lugares populares van de gratis a 20,000 KRW.",
  "/travel-basics":
    "SIM/eSIM, tarjeta o efectivo y seguridad en Corea, explicado en 5 minutos. Un plan SIM tipico cuesta aprox. 15,000-30,000 KRW.",
  "/before-you-go":
    "Entrada, documentos y llegada al aeropuerto en 6 minutos. Ten listos 3 basicos: pasaporte, reservas y requisitos de entrada.",
  "/shopping-and-deals":
    "Zonas de compras, tax refund y descuentos en 6 minutos. La elegibilidad y el monto del reembolso cambian segun tienda y compra.",
  "/latest-travel-updates-for-korea":
    "Actualizado para 2026. Revisa requisitos de entrada, K-ETA, aeropuerto, transporte y clima antes de reservar o volar.",
  "/korea-now-and-more":
    "Contexto semanal de Corea en unos 5 minutos. Te ayuda a ajustar el plan segun el momento local.",
  "/this-week-in-korea":
    "Corea esta semana en unos 2 minutos. Punto rapido de control antes de salir y durante el viaje.",
};
const ROUTE_META_TITLE_OVERRIDES: Record<string, string> = {
  "/latest-travel-updates-for-korea":
    "Actualizaciones de Viaje a Corea 2026: Entrada, K-ETA y Aeropuerto",
};
const routePath = segments.length ? `/${segments.join("/")}` : "/";
const routePathWithSlash = routePath === "/" ? "/" : `${routePath}/`;
const pageDescription =
  (node ? ROUTE_META_DESCRIPTION_OVERRIDES[routePath] : undefined) ??
  node?.description ??
  notFoundDesc;
const canonicalPath = withLang(routePath, lang);
const canonicalUrl = absoluteUrl(
  canonicalPath === "/" ? "/" : `${canonicalPath.replace(/\/+$/, "")}/`
);
const alternateEnUrl = absoluteUrl(routePathWithSlash);
const alternateEsUrl = canonicalUrl;

const pageTitle = node
  ? `${ROUTE_META_TITLE_OVERRIDES[routePath] ?? node.title} | ${siteName}`
  : `${notFound} | ${siteName}`;

const bodyClass = node ? (node.children && node.children.length > 0 ? "page--sub" : "page--leaf") : "page--sub";
const nodeForRender = node
  ? {
      ...node,
      updatedIso: getPageUpdatedIso(routePath, lang, node.updatedIso),
    }
  : undefined;
const schemaNodes = node
  ? nodeForRender!.children && nodeForRender!.children.length > 0
    ? buildCollectionSchemaNodes({
        canonicalUrl,
        routePath,
        node: nodeForRender!,
        lang,
        description: pageDescription,
      })
    : buildLeafSchemaNodes({
        canonicalUrl,
        node: nodeForRender!,
        lang,
        description: pageDescription,
        segments,
      })
  : [];
---

{node ? (
  <BaseLayout
    title={pageTitle}
    description={pageDescription}
    bodyClass={bodyClass}
    lang={lang}
    canonicalUrl={canonicalUrl}
    alternateEnUrl={alternateEnUrl}
    alternateEsUrl={alternateEsUrl}
    breadcrumbs={breadcrumbs}
    schemaNodes={schemaNodes}
    updatedIso={nodeForRender.updatedIso}
  >
    <TreePage
      node={nodeForRender}
      segments={segments}
      parentPath={withLang(parentPath, lang)}
      isHome={segments.length === 0}
      breadcrumbs={breadcrumbs}
      lang={lang}
    />
  </BaseLayout>
) : (
  <BaseLayout
    title={pageTitle}
    description={pageDescription}
    bodyClass="page--leaf"
    lang={lang}
    canonicalUrl={canonicalUrl}
    alternateEnUrl={alternateEnUrl}
    alternateEsUrl={alternateEsUrl}
    breadcrumbs={breadcrumbs}
    schemaNodes={schemaNodes}
    noindex
  >
    <section style="padding: 64px 0; text-align: center;">
      <h1 class="t-h1" style="font-family: Fraunces, serif;">{notFound}</h1>
      <p class="t-subheading" style="color: #5f6b84;">{notFoundDesc}</p>
      <a
        href={withLang("/", lang)}
        style="display: inline-flex; margin-top: 18px; padding: 10px 18px; border-radius: 999px; background: #1f6f8b; color: #fff;"
      >
        Go Home
      </a>
    </section>
  </BaseLayout>
)}
